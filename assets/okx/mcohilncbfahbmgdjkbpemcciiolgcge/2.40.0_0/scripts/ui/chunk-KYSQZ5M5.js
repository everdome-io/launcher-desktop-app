import{c as Fe,d as Se}from"./chunk-POEDNLGY.js";import{D as oe,E as c,L as mo,Y as po,ja as Be,l as O,la as Re,qa as f}from"./chunk-KRRNVCWZ.js";import{Aa as L,Ab as ie,Db as we,Fb as ce,Pa as io,al as lo,bc as E,dg as _,e as h,el as pe,fg as Ne,gg as le,i as a,ja as I,k as s,na as Ro,oa as so,tg as me,wa as i,wb as Q,yb as co,zb as se}from"./chunk-YC2Z7II3.js";a();s();var k=h(I());var g=h(so()),ho=h(Ro());a();s();var fe=(t,n)=>{let o=t.find(e=>(e==null?void 0:e.checkType)===n);return o?!(o!=null&&o.result):!1},Oe=t=>{let n=t.find(e=>(e==null?void 0:e.checkType)===_.SAFE_ADDRESS)||{};return Boolean(n.blackAddress)},We=t=>(t.find(o=>(o==null?void 0:o.checkType)===_.SAFE_ADDRESS)||{}).isSimilar,fo=(t,n,o)=>{let e=t.find(r=>(r==null?void 0:r.checkType)===_.OVERWRITTEN)||{};return e.toastType===Ne.FAILED?n():e.toastType===Ne.PENDING?o():t},uo=(t,n,o)=>{let{userGasInfo:e,serverGasInfo:r,originTxGasInfo:d}=n,{originGasPrice:A,originPriorityFee:G}=d,{supportEip1559:N}=e;if(N){let w=!1,{maxFeePerGas:Y,maxPriorityFeePerGas:C}=e,{normal:z,proposePriorityFee:M}=r,y=A,Z=G,F=ie([Y,z,y]);ce(F,Y)||(w=!0);let D=ie([C,M,Z]),j="0";return ce(D,C)||(j=se(D,C),w=!0),w?o({maxFeePerGas:co(F,j),maxPriorityFeePerGas:D}):t}let{gasPrice:v}=e,{normal:W}=r,m=ie([v,W,A]);return ce(m,v)?t:o({gasPrice:m})},Co=(t,n,o)=>{let{userGasInfo:e,updateGasInfo:r,baseCoinAmountAvailable:d}=n,{supportEip1559:A,gasLimit:G}=e;if(A){let{maxFeePerGas:v}=r;return we(Q(v,G),d)?o():t}let{gasPrice:N}=r;return we(Q(N,G),d)?o():t};a();s();a();s();var Ue=h(I());a();s();var Ye=h(I());var Oo=({...t})=>Ye.default.createElement(L.Prompt,{alignBottom:!1,hideCloseBtn:!0,infoType:L.Prompt.INFO_TYPE.warn,confirmBtnProps:{type:i.TYPE.highlight,size:i.SIZE.lg},cancelBtnProps:{category:i.CATEGORY.outline,size:i.SIZE.lg},...t}),U=Ye.default.memo(Oo);var Wo=({visible:t,address:n,onConfirm:o,onCancel:e})=>{let r=f(),d=me(n);return Ue.default.createElement(U,{visible:t,title:r("wallet_extension_scam_popup_risk_warning"),confirmText:r("wallet_extension_scam_popup_btn_reject"),cancelText:r("wallet_extension_scam_popup_btn_continue"),text:r("wallet_extension_scam_popup_risk_warning_desc",{accountAddress:d}),onConfirm:o,onCancel:e})},ze=Ue.default.memo(Wo);a();s();var Me=h(I());var Yo=({visible:t,onConfirm:n,onCancel:o})=>{let e=f();return Me.default.createElement(U,{visible:t,title:e("wallet_extension_address_popup_security_alert"),confirmText:e("wallet_extension_address_popup_btn_cancel"),cancelText:e("wallet_extension_address_popup_btn_continue"),text:e("wallet_extension_address_popup_security_alert_desc"),onConfirm:n,onCancel:o})},Ze=Me.default.memo(Yo);a();s();var je=h(I());a();s();var V=h(I());var Uo=({title:t,text:n,...o})=>V.default.createElement(L.Prompt,{className:"tx-check-dialog",alignBottom:!1,titleCenter:!1,infoType:null,renderContent:e=>V.default.createElement(e,null,V.default.createElement("div",{className:"tx-check-dialog__content"},V.default.createElement("div",{className:"tx-check-dialog__content-title"},t),V.default.createElement("div",{className:"tx-check-dialog__content-text"},n))),cancelBtnProps:{category:i.CATEGORY.outline,size:i.SIZE.lg},confirmBtnProps:{type:i.TYPE.highlight,size:i.SIZE.lg},...o}),ue=V.default.memo(Uo);var zo=({visible:t,onConfirm:n,onCancel:o})=>{let e=f();return je.default.createElement(ue,{visible:t,title:e("wallet_extension_transaction_popup_failed_transaction"),text:e("wallet_extension_transaction_popup_replace_failed_transaction"),confirmText:e("wallet_extension_transaction_popup_btn_replace"),cancelText:e("wallet_extension_transaction_popup_btn_skip"),onConfirm:n,onCancel:o})},He=je.default.memo(zo);a();s();var Le=h(I());var Mo=({visible:t,onConfirm:n,onCancel:o})=>{let e=f();return Le.default.createElement(ue,{visible:t,title:e("wallet_extension_transaction_popup_pending_transaction"),text:e("wallet_extension_transaction_popup_replace_pending_transaction"),confirmText:e("wallet_extension_transaction_popup_btn_replace"),cancelText:e("wallet_extension_transaction_popup_btn_continue_wait"),onConfirm:n,onCancel:o,hideCloseBtn:!0})},Ve=Le.default.memo(Mo);a();s();var Xe=h(I());var Zo=({visible:t,onConfirm:n,onCancel:o})=>{let e=f();return Xe.default.createElement(U,{visible:t,title:e("wallet_extension_popup_repeat_order"),confirmText:e("wallet_extension_popup_repeat_order_btn_continue"),cancelText:e("wallet_extension_popup_repeat_order_btn_viewhistory"),text:e("wallet_extension_popup_repeat_order_desc"),onConfirm:n,onCancel:o})},qe=Xe.default.memo(Zo);a();s();var u=h(I());function jo({visible:t,onConfirm:n,onCancel:o,data:e}){let r=f(),{userGasInfo:d,updateGasInfo:A,baseCoin:G}=e,{gasPrice:N,maxFeePerGas:v}=A,{supportEip1559:W,gasLimit:m,gasPrice:w,maxFeePerGas:Y}=d,C=W?Y:w,z=Be(C,m,G),M=Re(C,m),y=W?v:N,Z=Be(y,m,G),F=Re(y,m);return u.default.createElement(L.Prompt,{visible:t,className:"ethereum-check-gas-dialog",alignBottom:!1,titleCenter:!1,infoType:null,onConfirm:n,onClose:o,confirmText:r("extension_toast_btn_confirmgasfee"),confirmBtnProps:{type:i.TYPE.highlight,size:i.SIZE.lg},renderContent:D=>u.default.createElement(D,null,u.default.createElement("div",{className:"ethereum-check-gas-dialog__title"},r("extension_toast_title_transaction_replace")),u.default.createElement("div",{className:"ethereum-check-gas-dialog__subtitle"},r("extension_toast_subtitle_gasincrease")),u.default.createElement("div",{className:"ethereum-check-gas-dialog__fee-title"},r("extension_toast_title_current_transaction")),u.default.createElement("div",{className:"ethereum-check-gas-dialog__fee"},u.default.createElement("div",{className:"ethereum-check-gas-dialog__fee__fee-detail"},z),u.default.createElement("div",{className:"ethereum-check-gas-dialog__fee__gas-detail"},M)),u.default.createElement("div",{className:"ethereum-check-gas-dialog__fee-title"},r("extension_toast_title_gasprice")),u.default.createElement("div",{className:"ethereum-check-gas-dialog__fee"},u.default.createElement("div",{className:"ethereum-check-gas-dialog__fee__fee-detail--speed"},Z),u.default.createElement("div",{className:"ethereum-check-gas-dialog__fee__gas-detail"},F)))})}var Je=(0,u.memo)(jo);a();s();var Ke=h(I());var Ho=({visible:t,address:n,onConfirm:o,onCancel:e})=>{let r=f(),d=me(n);return Ke.default.createElement(U,{visible:t,title:r("wallet_extension_scam_popup_risk_warning"),confirmText:r("wallet_extension_scam_popup_btn_reject"),cancelText:r("wallet_extension_scam_popup_btn_continue"),text:r("wallet_extension_modaldesc_riskaddress",{contractaddress:d}),onConfirm:o,onCancel:e})},Qe=Ke.default.memo(Ho);var de={ON_CHAIN:0,NEW:1},$e=({children:t,btnProps:n,dataForCheck:o,whetherCheckRepeat:e,onFailedCancel:r,onFailedConfirm:d,onPendingCancel:A,onPendingConfirm:G,onRepeatCancel:N,onRepeatConfirm:v,onGasReplaceCancel:W,onGasReplaceConfirm:m,onClick:w,beforeClick:Y,afterClick:C})=>{let z=f(),{fetchParams:M,userGasInfo:y,baseCoinAmountUse:Z}=o,F=(0,k.useRef)([]),D=(0,k.useRef)(de.NEW),j=(0,k.useRef)({}),B=(0,k.useRef)({}),$=(0,k.useRef)(!1),[Ce,{setTrue:he,setFalse:X}]=O(!1),[_e,{setTrue:ge,setFalse:te}]=O(!1),[ke,{setTrue:q,setFalse:xe}]=O(!1),[J,{setTrue:Te,setFalse:ne}]=O(!1),{coinId:H,from:re,to:De,amount:Pe,gasPrice:Ge}=M,{baseCoin:ae}=mo(H),{coinAmountInt:ye}=po(ae.coinId),be=async()=>{var K;let l={checkTypes:[_.REPEAT,_.OVERWRITTEN],coinId:H,from:re,to:De,amount:Pe,gasPrice:Ge},[{data:S=[]},{data:R}]=await Promise.all([pe(l),lo({coinId:H,address:re})]);F.current=S;let ve=((K=R==null?void 0:R.info)==null?void 0:K.gasPrice)||{};return j.current=ve,S},p=()=>F.current,b=()=>j.current,ee=()=>B.current,oo=()=>{let S=p().find(K=>(K==null?void 0:K.checkType)===_.OVERWRITTEN)||{},{gasPrice:R,priorityFee:ve}=S;return{originGasPrice:Q(R,1.1),originPriorityFee:Q(ve,1.1)}},Ie=()=>{D.current=de.ON_CHAIN},_o=()=>{D.current=de.NEW},go=l=>(B.current={...B.current,...l},B.current),ko=()=>{$.current=!0},xo=()=>{io.error({title:z("extension_toast_text_insufficient_balance")})},Ee=c(()=>{let l={nonce:0,updateGasInfo:null},S=F.current.find(R=>(R==null?void 0:R.checkType)===_.OVERWRITTEN)||{};return D.current===de.NEW?l.nonce=S.newNonce:l.nonce=S.nonce,$.current&&(B.current.gasPrice||B.current.maxFeePerGas)&&(l.updateGasInfo=B.current),l},w),To=oe(he,E),Do=oe(ge,E),Po=l=>fo(l,To,Do),Go=oe(go,Te,E),to=l=>uo(l,{userGasInfo:y,serverGasInfo:b(),originTxGasInfo:oo()},Go),yo=oe(xo,C,E),bo=l=>{let S=se(ye,Z);return Co(l,{userGasInfo:y,updateGasInfo:ee(),baseCoinAmountAvailable:S},yo)},no=e?l=>(fe(l,_.REPEAT)&&(q(),E()),l):ho.identity,ro=c(p,no,Ee),Ae=c(Ie,ro),ao=c(_o,ro),Io=c(r,X,ao),Eo=c(d,X,p,to,Ae),Ao=c(A,te,ao),vo=c(G,te,p,to,Ae),wo=c(N,xe,C),Fo=c(v,xe,Ee),So=c(W,ne,C,E),No=c(ko,m,ne,p,bo,Ae),Bo=c(Y,be,Po,no,Ee,C);return k.default.createElement(k.default.Fragment,null,k.default.createElement(i,{category:i.CATEGORY.fill,type:i.TYPE.highlight,size:i.SIZE.lg,block:!0,...n,onClick:Bo},t),k.default.createElement(He,{visible:Ce,onCancel:Io,onConfirm:Eo}),k.default.createElement(Ve,{visible:_e,onCancel:Ao,onConfirm:vo}),k.default.createElement(qe,{visible:ke,onCancel:wo,onConfirm:Fo}),k.default.createElement(Je,{visible:J,onCancel:So,onConfirm:No,data:{baseCoin:ae,userGasInfo:y,updateGasInfo:ee()}}))},Lo=$e;$e.propTypes={children:g.default.node,btnProps:g.default.object,dataForCheck:g.default.object,whetherCheckRepeat:g.default.bool,onFailedCancel:g.default.func,onFailedConfirm:g.default.func,onPendingCancel:g.default.func,onPendingConfirm:g.default.func,onRepeatCancel:g.default.func,onRepeatConfirm:g.default.func,onClick:g.default.func,beforeClick:g.default.func,afterClick:g.default.func};$e.defaultProps={children:null,btnProps:{},dataForCheck:{},whetherCheckRepeat:!1,onFailedCancel:()=>{},onFailedConfirm:()=>{},onPendingCancel:()=>{},onPendingConfirm:()=>{},onRepeatCancel:()=>{},onRepeatConfirm:()=>{},onClick:()=>{},beforeClick:()=>{},afterClick:()=>{}};a();s();a();s();var P=h(I());var T=h(so());var eo=({children:t,btnProps:n,fetchParams:o,onDefraudCancel:e,onDefraudConfirm:r,onSimilarCancel:d,onSimilarConfirm:A,onToAddressCancel:G,onToAddressConfirm:N,onClick:v,beforeCheck:W,afterCheck:m})=>{let w=(0,P.useRef)([]),[Y,C]=(0,P.useState)(!1),[z,{setTrue:M,setFalse:y}]=O(!1),[Z,{setTrue:F,setFalse:D}]=O(!1),[j,{setTrue:B,setFalse:$}]=O(!1),{coinId:Ce,from:he,to:X,amount:_e,inputData:ge,txType:te}=o,ke=async()=>{C(!0);let p={checkTypes:[_.SAFE_ADDRESS,_.TO_ADDRESS],coinId:Ce,from:he,to:X,amount:_e,txType:te,inputData:ge||"0x"};try{let{data:b=[]}=await pe(p);return w.current=b,b}catch(b){console.log(b)}finally{C(!1)}return[]},q=()=>w.current,J=c(()=>{let p=q(),b=Oe(p),ee=We(p),Ie=[le.EXACT,le.ROUGH].includes(ee);return{isDefraud:b,isSimilar:Ie,similarType:ee}},v),Te=()=>{let p=q();Oe(p)&&(M(),Fe(),E())},ne=()=>{let p=q();We(p)===le.EXACT&&(F(),Fe(),E())},H=()=>{let p=q();fe(p,_.TO_ADDRESS)&&(B(),E())},re=c(W,ke,Te,ne,H,J,m),De=c(e,y,H,J,m),Pe=c(r,Se,y,m),Ge=c(d,D,H,J,m),ae=c(A,Se,D,m),ye=c(G,$,J,m),be=c(N,$,m);return P.default.createElement(P.default.Fragment,null,P.default.createElement(i,{category:i.CATEGORY.fill,type:i.TYPE.highlight,size:i.SIZE.lg,block:!0,...n,loading:n.loading||Y,onClick:re},t),P.default.createElement(ze,{visible:z,address:X,onConfirm:Pe,onCancel:De}),P.default.createElement(Qe,{visible:Z,address:X,onConfirm:ae,onCancel:Ge}),P.default.createElement(Ze,{visible:j,onConfirm:be,onCancel:ye}))},Vo=P.default.memo(eo);eo.propTypes={children:T.default.node,btnProps:T.default.object,fetchParams:T.default.object,onDefraudCancel:T.default.func,onDefraudConfirm:T.default.func,onSimilarCancel:T.default.func,onSimilarConfirm:T.default.func,onToAddressCancel:T.default.func,onToAddressConfirm:T.default.func,onClick:T.default.func,beforeCheck:T.default.func,afterCheck:T.default.func};eo.defaultProps={children:null,btnProps:{},fetchParams:{},onDefraudCancel:()=>{},onDefraudConfirm:()=>{},onToAddressCancel:()=>{},onToAddressConfirm:()=>{},onSimilarCancel:()=>{},onSimilarConfirm:()=>{},onClick:()=>{},beforeCheck:()=>{},afterCheck:()=>{}};export{Lo as a,Vo as b};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

