import{a as U,b as lt}from"./chunk-HU534ALX.js";import"./chunk-FJ7GWYCT.js";import{g as at,l as nt}from"./chunk-R6POV6JH.js";import{j as ot}from"./chunk-SBW523XW.js";import{c as rt,d as it}from"./chunk-NEW56Z2U.js";import{g as B}from"./chunk-HX34N4W4.js";import"./chunk-F7QJ6WQ5.js";import{a as yt}from"./chunk-TNVBYBO5.js";import{qa as P}from"./chunk-KRRNVCWZ.js";import{Ca as O,Hc as f,La as b,Na as G,Qa as L,Rc as j,Uc as Z,Wi as tt,Yc as X,Zc as D,_a as $,_i as et,ce as F,ci as J,e as y,ee as R,g as N,i as n,ja as S,k as l,na as ft,oa as H,oc as vt,pa as W,qi as Q,ub as wt,wa as c,yj as st}from"./chunk-YC2Z7II3.js";n();l();n();l();n();l();var w=y(S()),T=y(H());var ut=y(ft());n();l();var q=y(wt());n();l();var mt=y(vt());var Nt=async(o,r,t="")=>{let e={privateKey:r};lt.includes(t)&&(e.addressType=t===U.SEGWIT_NESTED_49?U.SEGWIT_NESTED:t);let{address:s,publicKey:a}=await(0,mt.getNewAddress)(o,e);return{privateKey:r,publicKey:a,address:s,addressType:t}};var Ct=async(o,r)=>{try{return await Nt(o,r),!0}catch{return!1}},pt=async(o,r=X)=>{let t=[];for(let e=0;e<r.length;e++){let s=r[e];await Ct(s,o)&&t.push(s)}return t};var V=async o=>{let t=(await pt(o)).map(e=>D[e]);return t.includes(f)&&(t=[...t,...Z]),t},ct=async o=>{let r=await V(o);return Boolean(r[0])},dt=async o=>(await V(o))[0]===j;n();l();var d=y(S()),k=y(H());n();l();var m=y(S());n();l();var I={disabledButton:"_disabledButton_83vmn_1",disabledButtonEvm:"_disabledButtonEvm_83vmn_9",imported:"_imported_83vmn_18"};var kt=({chainsList:o=[],description:r=""})=>{let t=(0,m.useMemo)(()=>o.length?o.slice(0,5):[],[o]);return m.default.createElement("div",{className:"choose-network-list-card__logos-wrap"},m.default.createElement(b,{title:r,maxWidth:224,placement:b.DIRECTION.bottomLeft},t.map((e,s)=>m.default.createElement("img",{alt:"evm",style:{left:-12*s,zIndex:10*s+1},key:s,src:e.image})),m.default.createElement(W,{className:"okx-wallet-plugin-more choose-network-list-card__more"})))};function Y({EVM_CHAINS:o,imported:r}){let t=P(),e=(0,m.useMemo)(()=>t("wallet_extension_select_network_toast_desc2",{network:o.map(s=>s.chainName).join("\u3001")}),[o]);return m.default.createElement("div",{className:"choose-network-list-card__EVM-wrap"},m.default.createElement("div",{className:"choose-network-list-card__title"},m.default.createElement("span",null," ",t("wallet_extension_select_network_title_evm_network")),m.default.createElement(b,{title:t("wallet_extension_select_network_toast_desc"),maxWidth:224,placement:b.DIRECTION.bottom},m.default.createElement(W,{className:"okx-wallet-plugin-information-circle",style:{color:"#929292",fontSize:"20px",marginLeft:"4px"}}))),m.default.createElement("p",{className:"choose-network-list-card__explain"},t("wallet_extension_select_network_text_support_network",{number:o.length})),m.default.createElement("p",{className:"choose-network-list-card__logos-wrap"},m.default.createElement(kt,{chainsList:o,description:e})),r&&m.default.createElement(c,{type:"grey",size:"small",disabled:!0,className:I.disabledButtonEvm},t("extension_wallet_import_active_wallet")))}n();l();var x=y(S()),ht=y(yt());function A({children:o,image:r,chainName:t,selected:e,handleClick:s,imported:a}){let h=P(),p=(0,ht.default)({[I.imported]:a},{"chains-choose-network-modal__chains-list-card":!0},{"chains-choose-network-modal__chains-list-card__selected":e});return x.default.createElement("div",{className:p,onClick:s},o||x.default.createElement("div",{className:"chains-choose-network-modal__chains-list-card__custom-wrap"},x.default.createElement(G,{alt:"image",className:"chains-choose-network-modal__chains-list-card__chain-icon",src:r}),x.default.createElement("span",{className:"chains-choose-network-modal__chains-list-card__chain-name"},t),a&&x.default.createElement(c,{type:"grey",size:"small",disabled:!0,className:I.disabledButton},h("extension_wallet_import_active_wallet"))))}n();l();function M({visible:o,setVisible:r,confirm:t,chooseNetworkList:e,supportChainsList:s,setChooseNetWorkList:a}){let h=P(),p=R(J),_=(0,d.useMemo)(()=>s.map(i=>i.chainName),[s]),g=(0,d.useMemo)(()=>p.filter(i=>{let K=_.indexOf(i.baseChain);return K>=0&&(i.imported=s[K].imported),K>=0&&i.baseChain!==f}),[p,_]),[v,u]=(0,d.useMemo)(()=>{let i=!1;return[p.filter(z=>(i=z.imported,z.baseChain===f)),i]},[p,g]);return o?d.default.createElement("div",{className:"chains-choose-network-modal__wrap"},d.default.createElement(B,{title:h("wallet_transfer_multichain_coin_maintitle_select_network"),className:"chains-choose-network-modal__navigator",onBack:()=>r(),closeable:!1}),d.default.createElement("div",{className:"chains-choose-network-modal__chains-list__wrap"},d.default.createElement("div",{className:"chains-choose-network-modal__chains-list__container"},_.includes(f)?d.default.createElement(A,{imported:u,selected:e.includes(f),handleClick:()=>{u||a(f)}},d.default.createElement(Y,{EVM_CHAINS:v,imported:u})):null,g.map(i=>d.default.createElement(A,{key:i.chainName,selected:e.includes(i.baseChain),handleClick:()=>{i.imported||a(i.baseChain)},...i}))),d.default.createElement("div",{className:"chains-choose-network-modal__confirm-button-wrap"},d.default.createElement(c,{block:!0,category:c.CATEGORY.fill,type:c.TYPE.highlight,size:c.SIZE.lg,onClick:i=>{i.preventDefault(),i.stopPropagation(),t()},className:"chains-choose-network-modal__confirm-button"},h("wallet_set_password_btn_confirm"))))):null}M.propTypes={visible:k.default.bool.isRequired,setVisible:k.default.func.isRequired,confirm:k.default.func.isRequired,chooseNetworkList:k.default.array.isRequired,supportChainsList:k.default.array.isRequired,setChooseNetWorkList:k.default.func.isRequired};n();l();var E=class extends w.PureComponent{constructor(t){super(t);N(this,"state",{privateKey:"",privateKeyError:"",isValid:!1,isImportPage:!1,chooseNetworkModalVisible:!1,chooseNetworkList:[],supportChainsList:[]});N(this,"setChooseNetworkModalVisible",t=>{this.setState({chooseNetworkModalVisible:!!t})});N(this,"setChooseNetWorkList",t=>{this.setState({chooseNetworkList:[t]})});N(this,"checkSelectWallet",async(t,e=[f])=>{let{keyringName:s="",walletName:a=""}=t||{},{history:h}=this.props,p=`${s}-${a}`;h.push({pathname:`${et}/key/${e[0]}`,state:{walletName:p,anim:"1",next:Q}})});N(this,"handleBack",()=>{let{history:t,setPrivateKey:e,setChooseNetworkList:s}=this.props;e(""),s([]),t.go(-1)});N(this,"validatePrivateKey",async()=>{let t="",{privateKey:e}=this.state,s=!0;e&&!await ct(e)&&(s=!1,t=this.context.t("wallet_import_errortip_wrong_private_key")),e&&await dt(e)&&(s=!1,t=this.context.t("extension_custom_network_errortip_sui_unavailable")),this.setState({privateKeyError:t,isValid:s,chooseNetworkList:[]})});N(this,"handleCleanBtnClick",async()=>{this.setState({privateKey:"",privateKeyError:""})});N(this,"handleImport",async t=>{if(t.preventDefault(),!this.isValid())return;let{privateKey:e}=this.state,s=e.trim(),a=await V(s),h=[];for(let v=0,u=a.length;v<u;v++)h.push($().checkPrivateKeyIsImported({baseChains:[a[v]],wallets:[{privateKey:s}]}));let p=await Promise.allSettled(h),_=null,g=p.map((v,u)=>{let{value:i}=v;return!i&&!_&&(_=a[u]),!i&&a[u]===f&&(_=f),{chainName:a[u],imported:i}});_?(this.setState({supportChainsList:g,chooseNetworkList:[_]}),this.setChooseNetworkModalVisible(!0)):L.error({title:this.context.t("wallet_extension_imported_toast_wallet_existes"),top:0})});N(this,"confirm",async()=>{if(!this.isValid())return;let{t}=this.context,{privateKey:e,isImportPage:s,chooseNetworkList:a}=this.state,{history:h,setPrivateKey:p,setChooseNetworkList:_,importWalletWithPrivateKey:g}=this.props,v,u=e.trim();try{s?v=await g(u,a):(await p(u),await _(a)),s?this.checkSelectWallet(v,a):h.push(tt)}catch(i){i.message===rt&&L.error(t("wallet_home_toast_network_error")),i.message===it&&(L.error(t("extension_wallet_addwallet_toast_wallets_added",{amount:100})),this.setState({privateKeyError:t("extension_wallet_addwallet_toast_wallets_added",{amount:100})}))}});this.dValidatePrivateKey=(0,ut.debounce)(this.validatePrivateKey,500)}componentDidMount(){let{history:t}=this.props,e=t.location.pathname===st;this.setState({isImportPage:e})}componentWillUnmount(){this.setState({privateKey:"",privateKeyError:"",isValid:!1})}isValid(){let{privateKey:t,privateKeyError:e,isValid:s}=this.state;return t&&s&&!e}handlePrivateKeyChange(t){this.setState({privateKey:t,privateKeyError:""}),this.dValidatePrivateKey()}render(){let{t}=this.context,{privateKeyError:e,isImportPage:s,chooseNetworkList:a,supportChainsList:h,chooseNetworkModalVisible:p}=this.state;return w.default.createElement("div",{className:"first-time-import__wrap main-container"},w.default.createElement(B,{bordered:!1,onBack:this.handleBack,closeable:!!s}),w.default.createElement("form",{className:"first-time-import__form",onSubmit:this.handleImport},w.default.createElement("div",{className:"first-time-import__header"},t("wallet_import_maintitle_import_private_key")),w.default.createElement("div",{className:"first-time-import__content-wrapper"},w.default.createElement("div",{className:"first-time-import__input-container"},w.default.createElement(O,{value:this.state.privateKey,type:"password",size:O.SIZE.lg,placeholder:t("wallet_import_placeholder_import_private_key"),onChange:_=>this.handlePrivateKeyChange(_.target.value),errorType:"blur",error:e,cleanable:!0}))),w.default.createElement(c,{htmlType:"submit",className:"first-time-import__button",disabled:!this.isValid(),category:c.CATEGORY.fill,type:c.TYPE.highlight,size:c.SIZE.lg,onClick:this.handleImport,block:!0},t("wallet_set_password_btn_confirm"))),w.default.createElement(M,{visible:p,chooseNetworkList:a,supportChainsList:h,setVisible:this.setChooseNetworkModalVisible,setChooseNetWorkList:this.setChooseNetWorkList,confirm:this.confirm}))}};E.contextTypes={t:T.default.func};E.propTypes={history:T.default.object.isRequired,setPrivateKey:T.default.func.isRequired,importWalletWithPrivateKey:T.default.func.isRequired,setChooseNetworkList:T.default.func.isRequired};var Et=o=>({setPrivateKey:r=>o(at(r)),importWalletWithPrivateKey:(r,t=[])=>o(ot(t,r)),setChooseNetworkList:r=>o(nt(r))}),gt=F(null,Et)(E);export{gt as default};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

