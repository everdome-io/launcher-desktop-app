import"./chunk-LRBTGOAF.js";import{a as _e,b as we}from"./chunk-CYZJ2MTU.js";import{a as _}from"./chunk-LFHLA7U2.js";import"./chunk-FJ7GWYCT.js";import{a as he}from"./chunk-FQDBFLDR.js";import"./chunk-TXMRZH72.js";import{a as ge}from"./chunk-XOJLATKP.js";import"./chunk-UJXR2XAQ.js";import{b as pe}from"./chunk-HXYG5WFL.js";import{i as D,j as z,k as F}from"./chunk-POEDNLGY.js";import{h as ue}from"./chunk-R6POV6JH.js";import"./chunk-IWZNXKTF.js";import{Ca as ie,I as te,J as re,L as se,M as ae,O as ne,Q as oe,v as J,w as K,x as Q,y as ee}from"./chunk-SBW523XW.js";import{c as le,d as ce,o as de}from"./chunk-NEW56Z2U.js";import"./chunk-HX34N4W4.js";import"./chunk-F7QJ6WQ5.js";import{a as be}from"./chunk-TNVBYBO5.js";import"./chunk-KRRNVCWZ.js";import{Ad as H,Ch as j,Ed as I,Fk as Z,Hd as k,Id as U,Qa as L,Rh as G,Wi as X,ce as R,e as g,g as l,i as m,ja as E,k as f,na as Ae,nh as $,oa as N,qh as V,qi as W,rg as Y,wa as d}from"./chunk-YC2Z7II3.js";m();f();var v=g(E()),i=g(N());var Pe=g(Ae());m();f();var p=g(N()),s=g(E());var He=(t="")=>{let{length:a}=t;return`${t.slice(0,6)}...${t.slice(a-6,a)}`},ke=(t,a)=>t?"/static/images/icons/icon-check-disabled.svg":a?"/static/images/icons/icon-check-active.svg":"/static/images/icons/icon-check-before.svg",xe=(t,a,e)=>{let r=a||e,o=t.find(c=>c.value===r)||t[0];return o==null?void 0:o.name},C=class extends s.Component{constructor(){super(...arguments);l(this,"state",{pathValue:null,page:0,isOpen:!1});l(this,"goToNextPage",()=>{this.props.accounts.length===5&&this.props.getPage(this.props.device,1,this.props.selectedPath),this.setState(e=>({page:e.page+1}))});l(this,"goToPreviousPage",()=>{let{page:e}=this.state;e!==0&&(this.props.getPage(this.props.device,-1,this.props.selectedPath),this.setState(r=>({page:r.page-1})))});l(this,"closeMenu",()=>{this.setState({isOpen:!1})})}setPath(e){this.setState({pathValue:e});let{onPathChange:r,selectedPath:o}=this.props;r(e||o)}renderHdPathSelector(){let{selectedPath:e,hdPaths:r}=this.props,{pathValue:o,isOpen:c}=this.state;return s.default.createElement("div",{className:"wallet-hardware-list-page__hdPath__select__wrapper"},s.default.createElement("div",{className:"wallet-hardware-list-page__hdPath__select__box",onClick:()=>this.setState({isOpen:!0})},xe(r,o,e),s.default.createElement("img",{src:c?"/static/images/icons/icon-select-up.svg":"/static/images/icons/icon-select-down.svg"})),s.default.createElement(_e,{isOpen:c,style:{position:"absolute",width:"100%",top:"56px",left:"0",zIndex:"55px"},innerStyle:{padding:"8px 0",borderRadius:"8px",background:"#FFFFFF",color:"#000000",border:"1px solid #EBEBEB",boxShadow:"0px 10px 15px -3px rgba(0, 0, 0, 0.1), 0px 4px 6px -2px rgba(0, 0, 0, 0.05)"}},r.map((h,u)=>s.default.createElement(we,{key:u,closeMenu:this.closeMenu,onClick:()=>{this.setPath(h.value),this.closeMenu()},style:{color:"#000000"}},s.default.createElement("div",{className:"wallet-hardware-list-page__hdPath__select-option"},s.default.createElement("span",null,h.name),h.value===e?s.default.createElement("img",{src:"/static/images/icons/icon-select-mark.svg"}):null)))))}capitalizeDevice(e){return e.slice(0,1).toUpperCase()+e.slice(1)}renderHeader(){return s.default.createElement(s.default.Fragment,null,s.default.createElement(_,{className:"wallet-connect-hardware-page__mini-title",type:"block",size:"large"},this.context.t("wallet_addwallet_subtitle_hardware_wallet_select_a_hd_path")))}renderAccounts(){let{accounts:e,connectedAccounts:r}=this.props;return s.default.createElement("div",{className:"hw-account-list"},s.default.createElement(_,{className:"wallet-connect-hardware-page__mini-title",type:"block",size:"large"},this.context.t("wallet_addwallet_subtitle_hardware_wallet_select_wallets")),s.default.createElement("div",{className:"wallet-hardware-list-page__list-container"},e.map(o=>{let c=r.includes(o.address.toLowerCase()),h=o.index,u=this.props.selectedAccounts.includes(o.index);return s.default.createElement("div",{key:o.address,className:"wallet-hardware-list-page__list-item",onClick:()=>{c||this.props.onAccountChange(h)}},s.default.createElement("div",{className:"wallet-hardware-list-page__list-item__textarea"},s.default.createElement(_,{type:"block"},He(o.address))),s.default.createElement("img",{className:"wallet-hardware-list-page__list-item__img",src:ke(c,u)}))}),this.renderPagination()))}renderPagination(){let{page:e}=this.state;return s.default.createElement("div",{className:"wallet-hardware-list-page__list-pagination"},s.default.createElement("img",{className:"wallet-hardware-list-page__list-pagination__icon-left",src:"/static/images/icon-pagination-arrow-left.svg",onClick:this.goToPreviousPage}),s.default.createElement("span",{className:"wallet-hardware-list-page__list-pagination__explain-text"},"Page ",e+1),s.default.createElement("img",{className:"wallet-hardware-list-page__list-pagination__icon-right",src:"/static/images/icon-pagination-arrow-right.svg",onClick:this.goToNextPage}))}renderButtons(){let e=this.props.selectedAccounts.length===0,r={};return e&&(r.disabled=!0),s.default.createElement("div",{className:"wallet-management__button__wrapper"},s.default.createElement(d,{category:d.CATEGORY.fill,type:d.TYPE.highlight,size:d.SIZE.lg,onClick:this.props.onUnlockAccounts.bind(this,this.props.device,this.props.selectedPath),className:"wallet-management__button",disabled:e},this.context.t("wallet_addwallet_btn_conncet_hardware_wallet")))}renderForgetDevice(){return s.default.createElement("div",{className:"wallet-hardware-list-page__forget-device-container"},s.default.createElement("a",{onClick:this.props.onForgetDevice.bind(this,this.props.device)},this.context.t("wallet_addwallet_subtitle_hardware_wallet_forget_conncetion")))}render(){return s.default.createElement(s.default.Fragment,null,s.default.createElement("div",{className:"wallet-management__container scroller-container wallet-hardware-list-page"},this.renderHeader(),this.renderHdPathSelector(),this.renderAccounts(),this.renderForgetDevice()),this.renderButtons())}};C.propTypes={onPathChange:p.default.func.isRequired,selectedPath:p.default.string.isRequired,device:p.default.string.isRequired,accounts:p.default.array.isRequired,connectedAccounts:p.default.array.isRequired,onAccountChange:p.default.func.isRequired,onForgetDevice:p.default.func.isRequired,getPage:p.default.func.isRequired,selectedAccounts:p.default.array.isRequired,onUnlockAccounts:p.default.func,hdPaths:p.default.array.isRequired};C.contextTypes={t:p.default.func,trackEvent:p.default.func};var fe=C;m();f();var M=g(be()),x=g(N()),n=g(E());var T=class extends n.Component{constructor(){super(...arguments);l(this,"state",{selectedDevice:null});l(this,"connect",()=>(z(),this.state.selectedDevice&&this.props.connectToHardwareWallet(this.state.selectedDevice),null))}renderConnectToTrezorButton(){return n.default.createElement("div",{className:(0,M.default)("wallet-connect-hardware-page__hardware-icon-item",{selected:this.state.selectedDevice==="trezor"}),onClick:()=>(D({hardwarewallet_brand:"trezor"}),this.setState({selectedDevice:"trezor"}))},n.default.createElement("img",{src:"/static/images/icon-trezor.svg",alt:"Trezor"}))}renderConnectToLedgerButton(){return n.default.createElement("div",{className:(0,M.default)("wallet-connect-hardware-page__hardware-icon-item",{selected:this.state.selectedDevice==="ledger"}),onClick:()=>(D({hardwarewallet_brand:"ledger"}),this.setState({selectedDevice:"ledger"}))},n.default.createElement("img",{src:"/static/images/icon-leadger.svg",alt:"Ledger"}))}renderButtons(){return n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:"wallet-connect-hardware-page__hardware-icon-container"},this.renderConnectToLedgerButton(),this.renderConnectToTrezorButton()))}renderContinueButton(){return n.default.createElement("div",{className:"wallet-management__button__wrapper"},n.default.createElement(d,{category:d.CATEGORY.fill,type:d.TYPE.highlight,size:d.SIZE.lg,onClick:this.connect,className:"wallet-management__button",disabled:!this.state.selectedDevice},this.context.t("wallet_addwallet_btn_conncet_hardware_wallet")))}renderUnsupportedBrowser(){return n.default.createElement("div",{className:"new-external-account-form unsupported-browser"},n.default.createElement("div",{className:"hw-connect"},n.default.createElement("h3",{className:"hw-connect__title"},this.context.t("wallet_addwallet_hardware_errortip_browser_not_supported")),n.default.createElement("p",{className:"hw-connect__msg"},this.context.t("wallet_addwallet_errortip_required_choreme_to_connect_hardware_wallet"))),n.default.createElement(d,{block:!0,category:d.CATEGORY.fill,type:d.TYPE.highlight,size:d.SIZE.lg,className:"wallet-management__button",onClick:()=>globalThis.platform.openTab({url:"https://google.com/chrome"})},this.context.t("wallet_addwallet_hardware_wallet_notify_download_chrome")))}renderHeader(){return n.default.createElement(n.default.Fragment,null,n.default.createElement(_,{className:"wallet-connect-hardware-page__mini-title",type:"block",size:"large"},this.context.t("wallet_add_wallet_subtitle_connect_hardware_select_a_hardware")),n.default.createElement(_,{className:"wallet-connect-hardware-page__mini-explain",size:"mini",weight:"400",style:{lineHeight:"22px",color:"#929292"}},this.context.t("wallet_add_wallet_subtitle_hardware_wallet_conncet_tip")))}renderConnectScreen(){let{t:e}=this.context;return n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:"wallet-management__container wallet-connect-hardware-page"},this.renderHeader(),this.renderButtons(),this.state.selectedDevice==="ledger"&&n.default.createElement("div",{className:"wallet-connect-hardware-page__connect__tip"},n.default.createElement("span",null,e("wallet_add_hardware_tutorials_ledger_connect_tips",{downloadUrl:n.default.createElement("span",{className:"wallet-connect-hardware-page__connect__tip-link",onClick:()=>globalThis.platform.openTab({url:"https://www.ledger.com/ledger-live/download"}),key:0},e("wallet_add_hardware_btn_ledger_client"))})))),this.renderContinueButton())}render(){return this.props.browserSupported?this.renderConnectScreen():this.renderUnsupportedBrowser()}};T.contextTypes={t:x.default.func};T.propTypes={connectToHardwareWallet:x.default.func.isRequired,browserSupported:x.default.bool.isRequired};var ve=T;var Ee="m/44'/60'/0'/0/0",Ce="m/44'/60'/0'",Ne="m/44'/60'/0'/0",Le=[{name:"Ledger Live",value:Ee},{name:"Legacy (MEW / MyCrypto)",value:Ce},{name:"BIP44 Standard (Trezor)",value:Ne}],A=class extends v.Component{constructor(){super(...arguments);l(this,"state",{selectedAccounts:[],accounts:[],browserSupported:!0,device:null});l(this,"connectToHardwareWallet",e=>{this.setState({device:e}),!this.state.accounts.length&&this.getPage(e,0,this.props.defaultHdPaths[e])});l(this,"onPathChange",e=>{this.props.setHardwareWalletDefaultHdPath({device:this.state.device,path:e}),this.setState({selectedAccounts:[]}),this.getPage(this.state.device,0,e)});l(this,"onAccountChange",e=>{let{selectedAccounts:r}=this.state;r.includes(e)?r=r.filter(o=>e!==o):r.push(e),this.setState({selectedAccounts:r})});l(this,"getPage",(e,r,o)=>{this.props.connectHardware(e,r,o,this.context.t("wallet_add_wallet_subtitle_hardware_wallet_connceting")).then(c=>{if(c.length){let h=c.map(u=>{var b;let y=u.address.toLowerCase(),P=((b=this.props.accounts[y])==null?void 0:b.balance)||null;return u.balance=P?Y(P,6,!0,this.props.nativeCurrency):"...",u});this.setState({accounts:h,device:e})}}).catch(c=>{let h=typeof c=="string"?c:c.message;h==="Window blocked"?this.setState({browserSupported:!1}):h!=="Window closed"&&h!=="Popup closed"&&this.props.showConfirmConnectHardErrorModal({onConfirm:()=>{this.connectToHardwareWallet(e)}})})});l(this,"onForgetDevice",e=>{this.props.forgetDevice(e).then(()=>{this.setState({selectedAccounts:[],accounts:[]})}).catch(Pe.noop)});l(this,"onUnlockAccounts",(e,r)=>{F();let{t:o}=this.context,{history:c,unlockHardwareWalletAccounts:h,updateToastHashMap:u,completedOnboarding:y}=this.props,{selectedAccounts:P}=this.state,b=k()===H,q=Ce===r?this.context.t("wallet_addwallet_hardware_wallet_subtitle_legacy_desc"):"";if(!y){let w={selectedAccounts:P,device:e,path:r||null,description:q};return this.props.setUnlockHardwareWallets(w),c.push(`${X}?from=${ge.HARDWARE}`),null}return h(P,e,r||null,q).then(w=>{let Te=w.map(S=>S==null?void 0:S.walletName).join("\u3001"),O="toastHash";u(O,{message:Te,status:"success"});let B=`${W}?toastHash=${O}`;b?c.push(B):globalThis.platform.openExtensionInPopup(B)}).catch(w=>{w.message===ce&&L.error(o("extension_wallet_addwallet_toast_wallets_added",{amount:100})),w.message===le&&L.error(o("wallet_home_toast_network_error"))})});l(this,"onCancel",()=>{let{history:e,mostRecentOverviewPage:r}=this.props;e.push(r)});l(this,"prevPage",()=>{if(!this.state.accounts.length){if(k()===H){this.props.history.go(-1);return}window&&window.close()}this.onForgetDevice(this.state.device)});l(this,"closeToDefaultPage",()=>{if(k()===H){this.props.history.push(W);return}window&&window.close()})}componentDidMount(){this.props.needSetLedgerLive&&this.props.openLedgerLivePreference(),this.checkIfUnlocked()}componentWillUnmount(){this.props.hideLoadingHardIndication()}async checkIfUnlocked(){for(let e of["trezor","ledger"]){let r=this.props.defaultHdPaths[e];await this.props.checkHardwareStatus(e,r)&&this.getPage(e,0,r)}}showTemporaryAlert(){this.props.showAlert(this.context.t("wallet_manage_wallet_subtitle_hardware_wallet_connceted")),setTimeout(()=>{this.props.hideAlert()},1e3*5)}renderContent(){return this.state.accounts.length?v.default.createElement(fe,{onPathChange:this.onPathChange,selectedPath:this.props.defaultHdPaths[this.state.device],device:this.state.device,accounts:this.state.accounts,connectedAccounts:this.props.connectedAccounts,selectedAccounts:this.state.selectedAccounts,onAccountChange:this.onAccountChange,chainId:this.props.chainId,rpcPrefs:this.props.rpcPrefs,getPage:this.getPage,onUnlockAccounts:this.onUnlockAccounts,onForgetDevice:this.onForgetDevice,onCancel:this.onCancel,hdPaths:Le}):v.default.createElement(ve,{connectToHardwareWallet:this.connectToHardwareWallet,browserSupported:this.state.browserSupported,useLedgerLive:this.props.useLedgerLive})}render(){return v.default.createElement(he,{onBack:this.prevPage,onClose:this.closeToDefaultPage,title:this.context.t("wallet_addwallet_maintitle_connect_hareware_wallet")},this.renderContent())}};A.propTypes={connectHardware:i.default.func.isRequired,checkHardwareStatus:i.default.func.isRequired,forgetDevice:i.default.func.isRequired,showAlert:i.default.func.isRequired,hideAlert:i.default.func.isRequired,unlockHardwareWalletAccounts:i.default.func.isRequired,setHardwareWalletDefaultHdPath:i.default.func.isRequired,showConfirmConnectHardErrorModal:i.default.func.isRequired,history:i.default.object.isRequired,chainId:i.default.string.isRequired,rpcPrefs:i.default.object.isRequired,accounts:i.default.object.isRequired,connectedAccounts:i.default.array.isRequired,defaultHdPaths:i.default.object.isRequired,mostRecentOverviewPage:i.default.string.isRequired,useLedgerLive:i.default.bool.isRequired,nativeCurrency:i.default.string.isRequired,needSetLedgerLive:i.default.bool.isRequired,openLedgerLivePreference:i.default.func.isRequired,hideLoadingHardIndication:i.default.func.isRequired,updateToastHashMap:i.default.func.isRequired};var De=t=>{var a;return{chainId:$(t),rpcPrefs:G(t),accounts:V(t),connectedAccounts:j(t),completedOnboarding:(a=t==null?void 0:t.metamask)==null?void 0:a.completedOnboarding,defaultHdPaths:t.appState.defaultHdPaths,mostRecentOverviewPage:pe(t),useLedgerLive:t.metamask.useLedgerLive,nativeCurrency:Z(t),needSetLedgerLive:U()!==I}},We=t=>({setHardwareWalletDefaultHdPath:({device:a,path:e})=>t(ne({device:a,path:e})),connectHardware:(a,e,r,o)=>t(Q(a,e,r,o)),checkHardwareStatus:(a,e)=>t(J(a,e)),forgetDevice:a=>t(K(a)),unlockHardwareWalletAccounts:(a,e,r,o)=>t(ee(a,e,r,o)),setUnlockHardwareWallets:a=>t(ue(a)),showAlert:a=>t(se(a)),hideAlert:()=>t(ae()),showConfirmConnectHardErrorModal:({onConfirm:a})=>t(te({name:"CONFIRM_CONNECTHARD_ERROR",onConfirm:a})),hideLoadingHardIndication:()=>{t(oe()),t(re())},openLedgerLivePreference:()=>{t(ie())},updateToastHashMap:(a,e)=>{de(a,e)}});A.contextTypes={t:i.default.func};var ut=R(De,We)(A);export{ut as default};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

