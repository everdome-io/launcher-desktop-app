import{a as w}from"./chunk-GCK4PCMX.js";import{N as y,P as S}from"./chunk-SBW523XW.js";import{l as C}from"./chunk-NEW56Z2U.js";import{$k as P,e as k,i as p,k as R,na as U,ul as D,wl as F}from"./chunk-YC2Z7II3.js";p();R();var A=k(U());var _=20,a=P({name:"txHistory",initialState:{filters:{status:[1,2,3,4],dates:w().stringDates,mainCoinId:""},txList:[],initLoading:!0,scrollLoading:!1,lastRowId:"",firstPageRefresh:!1,hasNewTx:!1},reducers:{setInitLoading:(t,e)=>{t.initLoading=e.payload},setScrollLoading:(t,e)=>{t.scrollLoading=e.payload},setFilters:(t,e)=>{t.filters={...t.filters,...e.payload}},setLastRowId:(t,e)=>{t.lastRowId=e.payload},setTxList:(t,e)=>{t.txList=e.payload},mergeTxList:(t,e)=>{t.txList=[...t.txList,...e.payload]},setFirstPageRefresh(t,e){t.firstPageRefresh=e.payload},setHasNewTx(t,e){t.hasNewTx=e.payload},resetFilters(t){t.filters={status:[1,2,3,4],dates:w().stringDates,mainCoinId:""}},resetTxHistory:t=>{t.txList=[],t.initLoading=!1,t.scrollLoading=!1,t.lastRowId="",t.firstPageRefresh=!1,t.hasNewTx=!1}}}),{actions:$,reducer:B}=a,tt=B,G=t=>t[a.name].txList,M=t=>t[a.name].filters,W=t=>{let e=M(t),{dates:[s,o],mainCoinId:n}=e;return{startDate:new Date(`${s} 00:00:00`).getTime(),endDate:new Date(`${o} 23:59:59`).getTime(),mainCoinId:n,status:[1,2,3,4]}},b=t=>t[a.name].initLoading,j=t=>t[a.name].scrollLoading,z=t=>t[a.name].lastRowId,J=t=>t.metamask.serverPushTx,et=t=>t.metamask.serverPushConfirmTx,st=t=>t[a.name].firstPageRefresh,rt=t=>t[a.name].hasNewTx,{setFilters:K,setTxList:I,mergeTxList:H,setInitLoading:N,setScrollLoading:v,resetTxHistory:ot,setLastRowId:q,setFirstPageRefresh:nt,setHasNewTx:at,resetFilters:it}=$;var O=(t,e={initLoad:!0,scrollLoad:!1,autoRefresh:!1,fromCoinDetail:!1})=>async(s,o)=>{var h;let n={...t},{initLoad:i,scrollLoad:r,autoRefresh:x,fromCoinDetail:f}=e,u=f?F:D;C(null);let c=o(),d=z(c),g=b(c),L=j(c);if(!(r&&(!d||L||g))){!x&&s(y()),i&&s(N(!0)),r&&s(v(!0)),i&&s(q("")),r&&(n.lastRowId=d);try{let m=await u(n),l=f?m:m.content;(0,A.isEmpty)(l)&&(l=[]),s(r?H(l):I(l));let T=l.length,E=T&&T%_===0?(h=l[T-1])==null?void 0:h.rowId:"";s(q(E))}catch{s(r?H([]):I([]))}!x&&s(S()),i&&s(N(!1)),r&&s(v(!1))}};function lt(){return(t,e)=>{let s=e(),o=G(s),n=J(s),i=(o||[]).findIndex(({txhash:r})=>r===n.oldTxHash||r===n.txhash);if(i!==-1){let r=o.slice(),{txId:x,txhash:f,txStatus:u,isShowPending:c,isShowSpeedUp:d,isShowCancel:g,pendingToastInfo:L}=n;return r[i]={...r[i],txId:x,txhash:f,txStatus:u,isShowPending:c,isShowSpeedUp:d,isShowCancel:g,pendingToastInfo:L},t(I(r)),!1}return!0}}function ct(t){return async(e,s)=>{await e(K(t));let o=s();e(O(W(o)))}}export{tt as a,G as b,M as c,W as d,b as e,J as f,et as g,st as h,rt as i,I as j,N as k,ot as l,q as m,nt as n,at as o,it as p,O as q,lt as r,ct as s};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

