import{a as nt}from"./chunk-MXVCAI6G.js";import{a as me,b as le,c as ue}from"./chunk-PGO4M2SB.js";import{b as pe}from"./chunk-4SCEKLXQ.js";import{a as ce}from"./chunk-ZHOBAN7R.js";import{da as ft,ea as Tt}from"./chunk-SBW523XW.js";import{g as rt}from"./chunk-HX34N4W4.js";import{P as Jt,T as Qt,V as Xt,Va as ne,Y as te,_a as se,bb as ie,c as Ue,da as ee,db as j,ha as oe,ia as re,ib as _t,l as H,pb as ae,qa as $}from"./chunk-KRRNVCWZ.js";import{$ as Me,$f as Gt,Aa as lt,Cb as B,Db as et,Eb as Pt,Fb as St,Gh as Ht,Gk as Yt,Hc as dt,Hf as A,Hk as Rt,Ik as Vt,Jk as $t,La as Et,Lk as Kt,Mk as E,Pa as vt,Pg as Dt,Rg as bt,Sg as Lt,Tg as U,Vg as Ft,Zh as zt,_f as M,de as ot,dg as V,e as C,ee as d,el as jt,i,ja as k,k as a,na as Nt,nd as Ot,nh as Bt,oa as gt,pa as kt,ra as X,rh as Mt,ta as N,tg as K,tk as Wt,ub as He,ud as R,vk as Zt,wa as u,wb as ut,wh as Ut,yb as wt,yl as qt,zb as tt}from"./chunk-YC2Z7II3.js";i();a();var x=C(k());i();a();var z=C(k()),de=C(Ue()),fe=C(gt());i();a();var q="interacted-with",Te=e=>{let t=$(),{value:r}=e;return z.default.createElement("div",{className:q},z.default.createElement(pe,{maxWidth:"170px",className:`${q}__title`,text:t("wallet_extension_popup_text_interact_with")}),z.default.createElement("div",{className:`${q}__data`},z.default.createElement("div",{className:`${q}__data-value`},K(r)),z.default.createElement(Et,{title:t("wallet_extension_top_copy_address")},z.default.createElement(kt,{className:`${q}__data-copy okx-wallet-plugin-copy`,onClick:()=>{(0,de.default)(r),vt.success({title:t("extension_toast_title_sendadd_copied"),desc:r,containerClassName:"address-copy-notification"})}}))))};Te.propTypes={value:fe.default.string.isRequired};var _e=Te;i();a();var D={nav:"_nav_1o8zw_1",main:"_main_1o8zw_4",buttonGroup:"_buttonGroup_1o8zw_10",center:"_center_1o8zw_25",group:"_group_1o8zw_30",mt20:"_mt20_1o8zw_39"};i();a();i();a();var ge=C(Nt()),W=C(k());var ke=C(He());i();a();var Ce=(e,t)=>{var p,l;let r=d(Ut),o=d(Zt),n=d(Mt);if(((p=o[e])==null?void 0:p.includes(n))&&r[n].account[dt]===t)return r[n]||{};let c=(l=o[e])==null?void 0:l.find(s=>{var m;return((m=r[s])==null?void 0:m.account[dt])===t});return c?r[c]:{}};i();a();var ye=C(k());i();a();var Ae=C(k());function xe({network:e,address:t,type:r,baseCoinId:o}){let{defaultShowCoinList:n}=d(s=>{let{defaultShowCoinList:m}=s.metamask;return{defaultShowCoinList:m}}),c=n.some(s=>{var _;return R(s.address,t,{baseCoinId:o})?!0:((_=s.childrenCoin)==null?void 0:_.length)>0&&s.childrenCoin.some(T=>R(T.address,t,{baseCoinId:o}))}),p=r===U.TOKEN_METHOD_APPROVE;return(0,Ae.useCallback)(async()=>{if(!c&&p){let s=await ft({contractAddress:t,chainInfo:e});await Tt(s)}},[e,t,c,p])(),{}}var Lo=e=>{let{networkType:t}=e,{account:r,walletName:o,keyringName:n}=Ie(e);return{address:r[t],walletName:o,keyringName:n}},he=e=>{let t=ot(),{id:r,type:o,txParams:n}=e,{to:c}=n,p=ae(),{coinId:l}=st(),s=c&&p.find(({address:S})=>R(c,S,{baseCoinId:l})),{symbol:m,decimals:_}=s||{},T=(s==null?void 0:s.image)||Vt,y=d(ie);(0,ye.useEffect)(()=>{y!==m&&t(j.setCurrentTxTokenSymbol({txId:r,tokenSymbol:m}))},[y,m,t,r]);let g=d(zt),h=Ne().type,w=Ot().filter(({localType:S})=>S===h)[0],I=w&&g.find(S=>S.coinId===w.coinId);xe({address:c,network:I||{},type:o,baseCoinId:l});let P=0,Z=0,Y="",F=!1,pt=d(se);if(o===U.TOKEN_METHOD_APPROVE){Z=Ft(n.data);let S=Lt(Z);Y=bt(Z),P=Z&&Dt(S,_).toFixed(),+P==0&&!pt&&(F=!0)}let Q=!1;return(F||o==="approve")&&(Q=!0),{tokenAddress:c,authorizedAmount:P,projectAddress:Y,isRevokeAuthorizedAmount:F,image:T,symbol:m,isApprove:Q}};var Xo=(e={})=>{let{origin:t}=e,o=d(Wt)[t]||{},n=o.icon||$t,c=o.name||Kt;return{...o,name:c,icon:n}},Ee=()=>d(Bt),st=()=>d(Yt);var Ie=e=>{let{origin:t,txParams:r}=e;return Ce(t,r.from)},Ne=()=>d(e=>e.metamask.provider),Ct=e=>(0,ke.isHexString)(e)&&et(e,0),tr=e=>{let{txParams:t={},type:r}=e,{gas:o,gasPrice:n,maxFeePerGas:c,maxPriorityFeePerGas:p}=t,l=o||t.gasLimit,s=M.SLOW;Ct(n)&&(s=M.CUSTOM),Ct(c)&&Ct(p)&&(s=M.CUSTOM),r===U.DEPLOY_CONTRACT&&(s=M.CUSTOM);let m=l||void 0,_=n||void 0,T=c||void 0,y=p||void 0,g=E(T),h=E(y);return{initialGasType:s,initialCustomMaxPriorityFee:h,initialCustomGasLimit:E(m),initialCustomGasPrice:E(_),initialCustomMaxBaseFee:tt(g,h)}},er=(e,t)=>{let{isRevokeAuthorizedAmount:r}=he(t),{type:o}=t,[n,c]=(0,W.useState)(o);(0,W.useEffect)(()=>{o==="approve"&&c(A.AUTHORIZATION),r&&c(A.CANCEL_AUTHORIZATION)},[]),(0,W.useEffect)(()=>{e&&[A.NFT_AUTHORIZATION,A.NFT_CANCEL_AUTHORIZATION].includes(e.txType)&&c(e.txType)},[e]);let p=()=>[A.AUTHORIZATION,A.CANCEL_AUTHORIZATION].includes(n),l=()=>[A.NFT_AUTHORIZATION,A.NFT_CANCEL_AUTHORIZATION].includes(n),s=()=>[A.AUTHORIZATION,A.NFT_AUTHORIZATION].includes(n),m=()=>[A.CANCEL_AUTHORIZATION,A.NFT_CANCEL_AUTHORIZATION].includes(n);return{txType:n,isTokenTx:p,isNftTx:l,isApproveTx:s,isRevokeTx:m,isApproveTokenTx:()=>p()&&s(),isRevokeTokenTx:()=>p()&&m(),isApproveNftTx:()=>l()&&s(),isRevokeNftTx:()=>l()&&m()}};var or=e=>{let{id:t}=e,r=ot();(0,W.useEffect)(()=>{r(j.setCurrentTxId({txId:t}))},[t]),(0,W.useEffect)(()=>{r(j.setCurrentTxData({currentTxData:(0,ge.cloneDeep)(e)}))},[e])};i();a();var Tr=e=>{let t=$(),{id:r}=e,o=st(),{coinId:n}=o,c=te(n),p=String(c.coinAmountInt),l=ee(n),s=d(Ht),{gasLimitInfo:m={},gasLimit:_,gasPrice:T,maxFeePerGas:y,gasType:g,supportEip1559:h,isGasLimitLoading:G,maxPriorityFeePerGas:w}=d(mt=>ne(mt,r)||{}),{txParams:I={}}=e,P=E(I.value),Z=_t(P,o),Y=h?y:T,F=ut(Y,_),pt=oe(Y,_,o),Q=`${t(Gt[g||M.STANDARD])} ${pt} `,S=wt(P,F),yt=_t(S,o),be=Xt(ut(yt,l),{symbol:s.symbol}),ht=!0;St(P,0)||(ht=B(P,tt(p,F)));let Le=Pt(p,F),Fe=et(P,0),Be=re(Y,_,o),It=mt=>Qt(mt,{fixed:o.vdecimalNum});return{rate:l,totalCostDecem:It(yt),transactionTotalDisplay:be,isSufficientBalance:ht,gasLimitInfo:m,customGasLimit:_,customGasPrice:T,gasCoinDisplay:Q,gasFeeCurrencyDisplay:Be,supportEip1559:h,customMaxFeePerGas:y,isSufficientGas:Le,isGasLimitLoading:G,customMaxPriorityFeePerGas:w,ethTransactionAmount:It(Z),hasBaseCoinChange:Fe}};i();a();i();a();var yr="Unknown",hr={[A.NFT_AUTHORIZATION]:"wallet_extension_subtitle_approveall",[A.NFT_CANCEL_AUTHORIZATION]:"wallet_extension_subtitle_revokeall"},ve={[A.NFT_AUTHORIZATION]:"wallet_extension_title_approve",[A.NFT_CANCEL_AUTHORIZATION]:"wallet_extension_title_revoke_approve"},At={approve:"wallet_extension_popup_btn_approve",cancelApprove:"wallet_extension_popup_btn_revoke_approval","Contract Deployment":"wallet_extension_popup_title_contract_interaction","Contract Interaction":"wallet_extension_popup_title_contract_interaction"},Ir={zh_CN:"https://www.ouyicn.life/academy/zh/secure-your-account",en:"https://www.okx.com/academy/en/safeguarding-your-fund-against-crypto-theft"};var we="wallet_extension_popup_title_contract_interaction",vr=(e,t)=>{if(!e)throw new Error("you have to pass txTypeUtil param to useTitleKey");let{type:r}=t,o=we,{isNftTx:n,txType:c,isRevokeTokenTx:p}=e;return p()?o=At.cancelApprove:o=At[r]||we,n()&&(o=ve[c]),o};i();a();var ze=C(k());i();a();var Pe=C(k());var We=C(Nt());i();a();var it=C(k());var jr=e=>{let{txParams:t}=e,r=Ee(),[o,{setFalse:n}]=H(!0),[c,p]=(0,it.useState)({});return(0,it.useEffect)(()=>{let l=r||"0x1",s={contractAddress:t.to,chainId:Number(E(l)),inputData:t.data};(async()=>{try{let{data:m}=await qt(s);p(m)}catch{}finally{n()}})()},[]),{analyseLoading:o,analyzedResult:c}};i();a();var b=C(k());i();a();var Se=C(Me()),xt=async e=>{let t=0,r=!1,o={};try{let{data:n=[]}=await jt(e);return n==null||n.forEach((c={})=>{c.checkType===V.SAFE_ADDRESS&&(r=c.result===!1,o=c),c.checkType===V.OVERWRITTEN&&(t=c.newNonce)}),{nonce:t,isScamAddress:r,safeAddressData:o}}catch{Se.default.error("Call postTxToastCheck Api failed")}return{nonce:t,safeAddressData:o,isScamAddress:r}};function on(e){let{isGasLimitLoading:t,gasLimit:r,gasPrice:o,maxFeePerGas:n,maxPriorityFeePerGas:c,supportEip1559:p}=e;return t||B(r,0)||p&&(B(n,0)||B(c,0))||!p&&B(o,0)}var un=({approveTokenInfo:e,coinId:t,tx:r})=>{let[o,n]=(0,b.useState)({}),[c,p]=(0,b.useState)(0),{to:l,from:s,value:m,data:_}=(r==null?void 0:r.txParams)||{},T=(0,b.useMemo)(()=>({checkTypes:[V.SAFE_ADDRESS,V.OVERWRITTEN],coinId:t,from:s,to:l,amount:E(m),inputData:_,domain:origin}),[t,s,l,m,_,origin]),[y,{setTrue:g}]=H();(0,b.useEffect)(()=>{T.to&&T.coinId&&(async()=>{let I=await xt(T);p(I.nonce),I.isScamAddress&&g(),n(I.safeAddressData)})()},[]);let[h,{setTrue:G}]=H();(0,b.useEffect)(()=>{T.to&&T.coinId&&e.projectAddress&&(async()=>{let I=await xt({...T,projectAddress:e.projectAddress});p(I.nonce),I.isScamAddress&&G()})()},[]);let w=y&&l||h&&e.projectAddress;return{nonce:c,grayAddress:w,safeAddressData:o}},Oe=()=>{let e=d(({metamask:n})=>n.currentLocale);return`https://${Jt()}`+(e==="zh_CN"?"/academy/zh/secure-your-account/":"/academy/en/safeguarding-your-fund-against-crypto-theft/")};i();a();var v=C(k());i();a();var Ge=C(k());var at=C(gt());i();a();var Ze="error-tip",ct=e=>{let{title:t,children:r,type:o}=e;return Ge.default.createElement(X,{className:Ze,title:t,type:o,closable:!1,desc:r})};ct.TYPE=X.TYPE;ct.propTypes={title:at.default.string.isRequired,children:at.default.node,type:at.default.string};ct.defaultProps={children:"",type:X.TYPE.error};var J=ct;var De=({grayAddress:e,isSufficientBalance:t=!0,isSufficientGas:r,setSupplyGasVisible:o,baseCoinSymbol:n,gasLimitInfo:c,handleCancel:p,isOffline:l})=>{let s=$(),m=Oe(),[_,{setFalse:T}]=H(!0),y=()=>v.default.createElement(v.default.Fragment,null,v.default.createElement(lt.Prompt,{visible:_,title:s("wallet_extension_protocol_popup_risk_warning"),alignBottom:!1,hideCloseBtn:!0,infoType:lt.Prompt.INFO_TYPE.warn,confirmBtnProps:{type:u.TYPE.highlight,size:u.SIZE.lg,category:u.CATEGORY.fill},cancelBtnProps:{category:u.CATEGORY.outline,size:u.SIZE.lg},onCancel:T,onConfirm:p,confirmText:s("wallet_extension_address_popup_btn_cancel"),cancelText:s("wallet_extension_address_popup_btn_continue")},v.default.createElement("div",{className:"confirm-transaction--risk-desc"},s("wallet_extension_scam_popup_risk_warning_desc",{accountAddress:K(e)}))),v.default.createElement(J,{title:s("wallet_extension_scam_popup_risk_warning_desc",{accountAddress:K(e)})},v.default.createElement(N,{type:N.TYPE.primary,weight:N.WEIGHT.muted,size:N.SIZE.xs,onClick:()=>{globalThis.platform.openTab({url:m})}},s("wallet_extension_scam_toast_link_view_scams")))),g=()=>v.default.createElement(J,{title:s("wallet_extension_popup_dapp_insufficient_balance")},v.default.createElement(N,{type:N.TYPE.primary,weight:N.WEIGHT.muted,size:N.SIZE.xs,onClick:()=>{o(!0)}},s("wallet_extension_placeorder_textbtn_replenish",{token:n}))),h=()=>v.default.createElement(J,{title:s("wallet_extension_popup_insufficient_network_fee",{token:n})},v.default.createElement(N,{type:N.TYPE.primary,weight:N.WEIGHT.muted,size:N.SIZE.xs,onClick:()=>{o(!0)}},s("wallet_extension_placeorder_textbtn_replenish",{token:n}))),G=()=>v.default.createElement(J,{title:s("wallet_extension_toast_text_unknown_error")});return()=>e?y():l?null:c!=null&&c.queryGasLimitErrorUseDefault?G():t?r?null:h():g()};var ns=({navTitle:e,walletInfo:t,unapproved:r,baseCoin:o,isSufficientGas:n,coinToDisplay:c,feeToDisplay:p,reject:l,confirm:s,rejectText:m,confirmText:_,loadingTx:T,loading:y})=>{var w,I;let[g,h]=(0,x.useState)(!1),G=De({isSufficientGas:n,setSupplyGasVisible:h,baseCoinSymbol:o.symbol});return x.default.createElement("div",{className:D.main},x.default.createElement(rt,{className:D.nav,title:e,closeable:!1,backable:!1}),G(),x.default.createElement(ce,{visible:g,closeCallback:()=>h(!1),coinId:o.coinId,txId:t.unapproved.id,receiveOnly:n}),x.default.createElement("div",{className:`${D.group} ${D.mt20}`},x.default.createElement(nt,{dappInfo:{icon:t.icon,name:t.name,host:t.host}})),x.default.createElement("div",{className:D.group},x.default.createElement(ue,{isSufficientGas:n,gasCoinDisplay:c,gasFeeCurrencyDisplay:p})),x.default.createElement("div",{className:D.group},x.default.createElement(me,{walletFieldData:{keyringName:t.keyringName,walletName:t.walletName,address:t.address}}),((I=(w=r.params)==null?void 0:w.transaction)==null?void 0:I.function)&&x.default.createElement(_e,{value:r.params.transaction.function}),x.default.createElement(le,{value:o.chainName,icon:o.image||Rt})),x.default.createElement("div",{className:D.buttonGroup},x.default.createElement(u,{category:u.CATEGORY.outline,type:u.TYPE.secondary,size:u.SIZE.md,block:!0,onClick:l},m),x.default.createElement(u,{block:!0,loading:T,category:u.CATEGORY.fill,type:u.TYPE.highlight,size:u.SIZE.md,disabled:!n||y,onClick:s},_)))};i();a();var O=C(k());i();a();var L={nav:"_nav_dcmzs_1",main:"_main_dcmzs_4",buttonGroup:"_buttonGroup_dcmzs_10",center:"_center_dcmzs_25",group:"_group_dcmzs_30",message:"_message_dcmzs_39",mt20:"_mt20_dcmzs_45"};var As=({navTitle:e,walletInfo:t,reject:r,confirm:o,message:n,rejectText:c,confirmText:p})=>O.default.createElement("div",{className:L.main},O.default.createElement(rt,{className:L.nav,title:e,closeable:!1,backable:!1}),O.default.createElement("div",{className:`${L.group} ${L.mt20}`},O.default.createElement(nt,{dappInfo:{icon:t.icon,name:t.name,host:t.host}})),O.default.createElement("div",{className:`${L.group} ${L.message}`},n),O.default.createElement("div",{className:L.buttonGroup},O.default.createElement(u,{category:u.CATEGORY.outline,type:u.TYPE.secondary,size:u.SIZE.md,block:!0,onClick:r},c),O.default.createElement(u,{block:!0,category:u.CATEGORY.fill,type:u.TYPE.highlight,size:u.SIZE.md,onClick:o},p)));export{_e as a,xe as b,Lo as c,he as d,Xo as e,st as f,Ne as g,tr as h,er as i,or as j,Tr as k,yr as l,hr as m,ve as n,At as o,Ir as p,vr as q,jr as r,on as s,un as t,J as u,De as v,ns as w,As as x};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

