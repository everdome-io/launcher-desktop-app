import{e as re,h as ne,i as ae,j as ie}from"./chunk-NEW56Z2U.js";import{g as le}from"./chunk-HX34N4W4.js";import{b as de}from"./chunk-F7QJ6WQ5.js";import{a as we}from"./chunk-TNVBYBO5.js";import{La as j,o as M,qa as v}from"./chunk-KRRNVCWZ.js";import{Aa as Q,Ca as N,Pa as L,Tk as oe,Xc as ee,e as E,ee as te,i as m,ja as P,k as _,ke as se,na as F,oa as xe,oc as $,wa as z,yc as R}from"./chunk-YC2Z7II3.js";m();_();var p=E(P());m();_();var Y=E(P());var ke=({type:i,addressId:d,addressInputValue:l,nameInputValue:a,networkSelectList:r,onClose:b,onDelete:f,onBackToHome:n})=>{let e=v(),o=se(),t=(0,Y.useRef)(!1),s=i===y.TYPE.EDIT,c=e(s?"wallet_extension_editaddress_title_edit_address":"wallet_extension_addaddress_title_add_address"),g=e(s?"wallet_extension_editaddress_modal_detele_address":"wallet_extension_addaddress_modal_cancel_adding"),x=e(s?"wallet_extension_editaddress_btn_detele":"wallet_extension_addaddress_btn_yes"),h=e(s?"wallet_extension_editaddress_btn_cancel":"wallet_extension_addaddress_btn_no"),w=l||a||r.length,k=()=>{let B=n&&n();o.push(B||"")},u=()=>{let B=Q.warn({title:g,alignBottom:!1,cancelText:h,confirmText:x,onCancel:()=>{B.destroy(),t.current=!1},onConfirm:async()=>{s?(await ie(d),L.success({title:e("wallet_extension_addressbook_toast_address_deleted")}),f&&f(),b()):t.current?k():b()}})};return Y.default.createElement(Y.default.Fragment,null,Y.default.createElement(le,{onBack:()=>{!s&&w?u():b()},title:c,onClose:()=>{s?u():w?(t.current=!0,u()):k()},closeable:s?{style:{color:"#E3493F"},icon:"okx-wallet-plugin-trash"}:!0}))},ce=ke;m();_();var O=E(P());var ue=E(F());function K({nameInputValue:i,nameInputError:d,setNameInputValue:l,setNameInputError:a}){let r=v(),b=(0,O.useRef)(),f=(0,O.useRef)(!1),n=d&&f.current?d:"",{run:e}=M(()=>{f.current=!0;let t="";(0,ue.size)(i)>20&&(t=r("wallet_extension_addaddress_errortip_maximum_20")),a(t)},{wait:50}),o=t=>{e(),l(t.target.value)};return(0,O.useEffect)(()=>{b.current.focus()},[]),O.default.createElement(N,{className:"address-edit-dialog__name-input",placeholder:r("wallet_extension_addaddress_input_enter_name_limit"),label:r("wallet_extension_addaddress_subtitle_name"),value:i,error:n,errorType:N.TIP_TYPE.always,size:N.SIZE.xl,onChange:o,maxLength:30,onRef:t=>{b.current=t}})}m();_();var A=E(P()),me=E(F()),V=E($());function W({type:i,addressId:d,address:l,addressInputValue:a,addressInputError:r,setAddressInputValue:b,setAddressInputError:f,onChangeToEdit:n}){let e=v(),o=i===y.TYPE.EDIT,t=j(a),s=!!(t!=null&&t.id)&&(!o||(t==null?void 0:t.id)!==d),c=(0,A.useRef)(!1),g=r&&c.current?r:"",x=async()=>{let u=[],C=Object.values(V.Currency).filter(D=>typeof D!="number");return await Promise.all(C.map(async D=>{try{let{isValid:B}=await(0,V.validAddress)(V.Currency[D].valueOf(),{address:a});B&&u.push(Number(V.Currency[D]))}catch{(0,me.noop)()}})),u},{run:h}=M(async()=>{c.current=!0;let u="";a&&((await x()).length||(u=e("wallet_extension_addaddress_errortip_wrong_address"))),s&&(u=e("wallet_extension_addaddress_errortip_address_exists")),f(u)},{wait:50}),w=u=>{h(),b(u.target.value)},k=()=>{n(t)};return A.default.createElement(A.default.Fragment,null,A.default.createElement(N.TextArea,{className:"address-edit-dialog__address-input",placeholder:e("wallet_extension_addaddress_input_enter_address"),disabled:!o&&l,label:e("wallet_extension_addaddress_subtitle_address"),value:a,error:!!g,errorType:N.TIP_TYPE.always,size:N.SIZE.xl,onChange:w,autoResize:!0}),g&&A.default.createElement("div",{className:"address-edit-dialog__address-input__error"},g,s&&A.default.createElement("span",{className:"address-edit-dialog__address-input__error-action",onClick:k},e("wallet_extension_addaddress_anchor_go_to_edit"))))}m();_();var S=E(P());var G=E(F());m();_();var I=E(P()),Z=E(xe()),U=E(we()),_e=E(F());m();_();var X=({className:i="",options:d=[],onChange:l=()=>{}})=>{let[a,r]=(0,I.useState)({}),[b,f]=(0,I.useState)({});(0,I.useEffect)(()=>{let e={},o={};for(let t=0;t<d.length;t++){let s=d[t];s.active&&(e[s.value]=s),s.disabled&&(o[s.value]=s)}r(e),f(o)},[d]);let n=e=>{if(e.disabled)return;let o=e.value,t=(0,_e.cloneDeep)(a);a[o]?(delete t[o],r(t)):(t[o]=e,r(t));let s=Object.values(t);l&&l(s)};return I.default.createElement("div",{className:(0,U.default)("ok-button-checkbox",i)},d.map((e,o)=>I.default.createElement("div",{className:(0,U.default)("ok-button-checkbox__item",{"ok-button-checkbox__item--active":!!a[e.value],"ok-button-checkbox__item--disabled":!!b[e.value]}),onClick:()=>{n(e)},key:o},e.image&&I.default.createElement("img",{className:"ok-button-checkbox__item-icon",src:e.image,alt:e.label}),I.default.createElement("span",{className:"ok-button-checkbox__item-text"},e.label))))};X.propTypes={className:Z.default.string,options:Z.default.array,onChange:Z.default.func};X.defaultProps={className:"",options:[],onChange:()=>{}};var pe=X;var H=E($());var Ee=[R];function q({network:i,networkSelectList:d,addressInputValue:l,addressInputError:a,setNetworkSelectList:r,setHasSelect:b}){let f=v(),n=te(oe),[e,o]=(0,S.useState)([]),t=c=>{if(!c.length){r([]);return}let g=c.map(x=>x.value);r(g)},s=async c=>{let g=[],x=Object.values(H.Currency).filter(w=>typeof w!="number");return await Promise.all(x.map(async w=>{try{let{isValid:k}=await(0,H.validAddress)(H.Currency[w].valueOf(),{address:c});k&&g.push(Number(H.Currency[w]))}catch{(0,G.noop)()}})),ee.filter(({coinType:w,localType:k})=>!Ee.includes(k)&&g.includes(w)).map(({chainName:w,localType:k})=>{let u=(0,G.get)(n.find(C=>C.localType===k),"image");return{disabled:i===k,active:d.includes(k),label:w,value:k,image:u}})};return(0,S.useLayoutEffect)(()=>{(async()=>{let c=await s(l);o(c),b(c.some(g=>g.active))})()},[l,d]),!l||a||!e.length?null:S.default.createElement("div",{className:"address-edit-dialog__network-select"},S.default.createElement("div",{className:"address-edit-dialog__network-select__title"},f("wallet_extension_addressbook_title_select_networks")),S.default.createElement(pe,{options:e,onChange:t}))}m();_();var fe=E(P());function J({type:i,addressId:d,nameInputValue:l,addressInputValue:a,networkSelectList:r,addressInputError:b,nameInputError:f,hasSelect:n,onClose:e}){let o=v(),t=i===y.TYPE.EDIT,s=l===""||a===""||b!==""||f!==""||!n||r.length===0,c=async g=>{g.stopPropagation();let x={address:a,name:l,networks:r};if(t)await ae(d,x),L.success({title:o("wallet_extension_editaddress_toast_edit_saved")}),e(x);else try{await ne(x),L.success({title:o("wallet_extension_addressbook_toast_address_added")}),e(x)}catch(h){(h==null?void 0:h.message)===re&&L.error({title:o("wallet_extension_addressbook_toast_address_limit_reached")})}};return fe.default.createElement(z,{className:"address-edit-dialog__save",disabled:s,category:z.CATEGORY.fill,type:z.TYPE.highlight,size:z.SIZE.lg,onClick:c,block:!0},o("wallet_set_password_btn_confirm"))}m();_();function y({type:i,data:d,onClose:l,onDelete:a,onBackToHome:r,onChangeToEdit:b}){let{id:f,address:n,network:e}=d,o=j(n),[t,s]=(0,p.useState)(""),[c,g]=(0,p.useState)(""),[x,h]=(0,p.useState)(""),[w,k]=(0,p.useState)(""),[u,C]=(0,p.useState)([]),[D,B]=(0,p.useState)(!0);return(0,p.useEffect)(()=>{if(i===y.TYPE.EDIT&&o){let{name:be,networks:ge}=o;h(be),s(n),C(ge)}else n&&s(n),e&&C([e])},[i,n,e]),p.default.createElement("div",{className:"address-edit-dialog"},p.default.createElement(ce,{type:i,addressId:f,address:n,addressInputValue:t,nameInputValue:x,networkSelectList:u,onClose:l,onDelete:a,onBackToHome:r}),p.default.createElement("div",{className:"address-edit-dialog__body"},p.default.createElement(K,{nameInputValue:x,nameInputError:w,setNameInputValue:h,setNameInputError:k}),p.default.createElement(W,{type:i,addressId:f,address:n,addressInputValue:t,addressInputError:c,setAddressInputError:g,setAddressInputValue:s,onChangeToEdit:b}),p.default.createElement(q,{network:e,networkSelectList:u,setNetworkSelectList:C,setHasSelect:B,addressInputValue:t,addressInputError:c})),p.default.createElement(de.FooterActions,null,p.default.createElement(J,{type:i,addressId:f,nameInputValue:x,addressInputValue:t,networkSelectList:u,addressInputError:c,nameInputError:w,hasSelect:D,onClose:l})))}y.TYPE={EDIT:"edit",ADD:"add"};export{y as a};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

