import{a as h}from"./chunk-UDJV67EY.js";import{N as D,P as N}from"./chunk-U3HLVTEP.js";import{l as E}from"./chunk-5TVTY5EZ.js";import{Jj as y,Xk as F,Zk as C,e as k,i as P,k as S,ka as M,le as x,re as g}from"./chunk-5YY3VNR7.js";P();S();var A=k(M());var O=20,i=y({name:"txHistory",initialState:{filters:{status:g.PENDING,dates:h().stringDates,mainCoinId:""},txList:[],initLoading:!0,scrollLoading:!1,lastRowId:"",firstPageRefresh:!1,hasNewTx:!1},reducers:{setInitLoading:(t,e)=>{t.initLoading=e.payload},setScrollLoading:(t,e)=>{t.scrollLoading=e.payload},setFilters:(t,e)=>{t.filters={...t.filters,...e.payload}},setLastRowId:(t,e)=>{t.lastRowId=e.payload},setTxList:(t,e)=>{t.txList=e.payload},mergeTxList:(t,e)=>{t.txList=[...t.txList,...e.payload]},setFirstPageRefresh(t,e){t.firstPageRefresh=e.payload},setHasNewTx(t,e){t.hasNewTx=e.payload},resetFilters(t){t.filters={status:g.PENDING,dates:h().stringDates,mainCoinId:""}},resetTxHistory:t=>{t.txList=[],t.initLoading=!1,t.scrollLoading=!1,t.lastRowId="",t.firstPageRefresh=!1,t.hasNewTx=!1}}}),{actions:_,reducer:$}=i,rt=$,b=t=>t[i.name].txList,B=t=>t[i.name].filters,W=t=>{let e=B(t),{dates:[s,n],mainCoinId:a}=e,{status:o}=e;return o===g.PENDING?o=[x.PENDING]:o=[x.CONFIRMING,x.ERROR,x.SUCCESS],{startDate:new Date(`${s} 00:00:00`).getTime(),endDate:new Date(`${n} 23:59:59`).getTime(),mainCoinId:a,status:o}},j=t=>t[i.name].initLoading,z=t=>t[i.name].scrollLoading,J=t=>t[i.name].lastRowId,K=t=>t.metamask.serverPushTx,ot=t=>t.metamask.serverPushConfirmTx,nt=t=>t[i.name].firstPageRefresh,at=t=>t[i.name].hasNewTx,{setFilters:Q,setTxList:R,mergeTxList:H,setInitLoading:v,setScrollLoading:G,resetTxHistory:it,setLastRowId:q,setFirstPageRefresh:lt,setHasNewTx:ct,resetFilters:xt}=_;var V=(t,e={initLoad:!0,scrollLoad:!1,autoRefresh:!1,fromCoinDetail:!1})=>async(s,n)=>{var p;let a={...t},{initLoad:o,scrollLoad:r,autoRefresh:f,fromCoinDetail:d}=e,L=d?C:F;E(null);let c=n(),u=J(c),m=j(c),T=z(c);if(!(r&&(!u||T||m))){!f&&s(D()),o&&s(v(!0)),r&&s(G(!0)),o&&s(q("")),r&&(a.lastRowId=u);try{let I=await L(a),l=d?I:I.content;(0,A.isEmpty)(l)&&(l=[]),s(r?H(l):R(l));let w=l.length,U=w&&w%O===0?(p=l[w-1])==null?void 0:p.rowId:"";s(q(U))}catch{s(r?H([]):R([]))}!f&&s(N()),o&&s(v(!1)),r&&s(G(!1))}};function ft(){return(t,e)=>{let s=e(),n=b(s),a=K(s),o=(n||[]).findIndex(({txhash:r})=>r===a.oldTxHash||r===a.txhash);if(o!==-1){let r=n.slice(),{txId:f,txhash:d,txStatus:L,isShowPending:c,isShowSpeedUp:u,isShowCancel:m,pendingToastInfo:T}=a;return r[o]={...r[o],txId:f,txhash:d,txStatus:L,isShowPending:c,isShowSpeedUp:u,isShowCancel:m,pendingToastInfo:T},t(R(r)),!1}return!0}}function dt(t){return async(e,s)=>{await e(Q(t));let n=s();e(V(W(n)))}}export{rt as a,b,B as c,W as d,j as e,K as f,ot as g,nt as h,at as i,Q as j,R as k,v as l,it as m,q as n,lt as o,ct as p,xt as q,V as r,ft as s,dt as t};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

